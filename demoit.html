<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@5"></script>

<h1>Vega : dynamic test of transform</h1>

<split-view>
    <div style="text-align: left">
        Output of Vega SPEC .demoit/js/data.vg.json
        <div id="my-controls"></div>
        <div id="my-chart-id"></div>
    </div>
    <div style="text-align: left; overflow-x: auto">
        result.vgSpec.data =
        <div title="vega output" id="output-id">...</div>
    </div>
</split-view>

<script>
const output = document.getElementById('output-id');

const spec = "js/data.vg.json";
    vegaEmbed("#my-chart-id", spec)
    // result.view provides access to the Vega View API
    .then(result => {
        console.log(result.view._runtime.data['mongo-status'].values.value);
        console.log(result.view._runtime.data['regions'].values.value);
        console.log(result.view._runtime.data['links'].values.value);
        console.log(result);
        output.innerHTML='<pre style="text-align: left;font-size:0.8em">'
            + JSON.stringify(result.vgSpec.data, null, 4)
        })                                
    .catch( err => {
        console.warn(err);
        output.innerHTML="<br>" + err;
    });
</script>